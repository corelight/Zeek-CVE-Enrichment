# @TEST-EXEC: zeek ../../../scripts/extract-cve %INPUT > out
# @TEST-EXEC: btest-diff out

global cases: string_vec = vector(
    "hello", "",
    "CVE-NOPE", "",
    "ET EXPLOIT Zoho ManageEngine Desktop Central RCE Inbound (CVE-2020-10189)", "CVE-2020-10189"
);

event zeek_init() {
    local n = 0;
    while (n < |cases|) {
        local i = cases[n];
        local ex = cases[n+1];
        local got = extract_cve(i);
        if (got == ex) {
            print fmt("OK extract_cve(%s) == '%s'", i, ex);
        }else {
            print fmt("FAIL extract_cve(%s) != '%s', got '%s'", i, ex, got);
        }
        n += 2;
    }
}
