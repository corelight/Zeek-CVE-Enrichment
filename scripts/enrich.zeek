module CVEEnrichment;

type Idx: record {
    ip: addr;
};

type Val: record {
    hostname: string;
    cve_list: string_set;
};


global cve_data: table[addr] of Val = table();

event zeek_init() {
    Input::add_table([
        $source="cve_data.csv",
        $name="cve_data",
        $idx=Idx,
        $val=Val,
        $destination=cve_data,
        $mode=Input::REREAD
    ]);
}
